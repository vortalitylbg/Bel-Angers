<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Bel'Angers — Tableau de bord (responsive fix)</title>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/dashboard.css">
  <link rel="shortcut icon" href="images/favicon.jpg" type="image/x-icon">
</head>
<body>
  <canvas id="bgCanvas"></canvas>

  <header>
    <nav class="navbar glass">
      <div class="nav-left">
        <span class="brand">Bel'Anger</span>
        <span id="welcomeMessage" class="welcome-text">Bienvenue</span>
      </div>

      <ul class="nav-links">
        <li><button class="nav-btn" data-section="calendar">Calendrier</button></li>
        <li><button class="nav-btn" data-section="clients">Clients</button></li>
        <li><button class="nav-btn" data-section="stats">Statistiques</button></li>
      </ul>

      <div class="nav-actions">
        <button class="btn glass-btn danger" id="logoutBtn">Déconnexion</button>
      </div>

      <div class="hamburger" aria-label="Menu" role="button">
        <span></span><span></span><span></span>
      </div>
    </nav>

    <div class="mobile-menu" aria-hidden="true">
      <ul>
        <li><button class="nav-btn" data-section="calendar">Calendrier</button></li>
        <li><button class="nav-btn" data-section="clients">Clients</button></li>
        <li><button class="nav-btn" data-section="stats">Statistiques</button></li>
        <li><button class="btn glass-btn danger" id="logoutBtnMobile">Déconnexion</button></li>
      </ul>
    </div>

    <div class="overlay"></div>
  </header>


  <main class="dashboard-main">
    <section id="calendarSection" class="dashboard-section active">
      <h2 class="first-h2">Votre calendrier</h2>
      <div id="calendar"></div>
    </section>

    <section id="clientsSection" class="dashboard-section">
      <h2 class="first-h2">Ajouter un client</h2>

      <!-- Formulaire ajout client -->
      <form id="addClientForm" class="glass client-form">
        <input type="text" id="clientName" placeholder="Nom complet" required>
        <input type="email" id="clientEmail" placeholder="Email" required>
        <input type="tel" id="clientPhone" placeholder="Téléphone">
        <textarea id="clientNotes" placeholder="Notes"></textarea>
        <button type="submit" class="btn glass-btn">Ajouter</button>
      </form>

      <h2>Ajouter une session</h2>
      <!-- Formulaire ajout heures -->
      <form id="addSessionForm" class="glass session-form">
        <label for="sessionClient">Client</label>
        <select id="sessionClient" required></select>

        <label for="sessionDate">Date</label>
        <input type="date" id="sessionDate" required>

        <label for="sessionTime">Heure de début</label>
        <input type="time" id="sessionTime" required>

        <label for="sessionEndTime">Heure de fin</label>
          <input type="time" id="sessionEndTime" required>

        <button type="submit" class="btn glass-btn">Ajouter une session</button>
      </form>

      <!-- Tableau des clients -->
      <h2>Liste des clients</h2>
      <div class="clients-table-wrapper">
        <table class="clients-table" id="clientsTable">
          <thead>
            <tr>
              <th>Nom</th>
              <th>Email</th>
              <th>Téléphone</th>
              <th>Notes</th>
              <th>Créé le</th>
            </tr>
          </thead>
          <tbody id="clientsList"></tbody>
        </table>
      </div>
      <div id="clientsListMobile"></div>

    </section>


    <section id="statsSection" class="dashboard-section">
      <div class="stats-container">
      <div class="stats-summary">
        <p><strong>Total d’heures :</strong> <span id="totalHours">–</span></p>
      </div>

      <div class="chart-block">
        <h3>Répartition des heures par client</h3>
        <canvas id="clientHoursChart"></canvas>
      </div>

      <div class="chart-block">
        <h3>Sessions par mois</h3>
        <canvas id="monthlySessionsChart"></canvas>
      </div>
    </div>

    </section>
  </main>

  <!-- Modal gestion session -->
  <div id="sessionModal" class="modal">
    <div class="modal-content glass">
      <span class="close" id="closeSessionModal">&times;</span>
      <h3>Gestion de la session</h3>

      <form id="editSessionForm">
        <label for="editSessionClient">Client</label>
        <select id="editSessionClient"></select>

        <label for="editSessionDate">Date</label>
        <input type="date" id="editSessionDate" required>

        <label for="editSessionTime">Heure de début</label>
        <input type="time" id="editSessionTime" required>

        <label for="editSessionEndTime">Heure de fin</label>
        <input type="time" id="editSessionEndTime" required>

        <div style="display:flex;justify-content:space-between;margin-top:1rem;">
          <button type="submit" class="btn glass-btn">Enregistrer</button>
          <button type="button" id="deleteSessionBtn" class="btn glass-btn danger">Supprimer</button>
        </div>
      </form>
    </div>
  </div>


  <footer>
    <p>© 2025 Bel'Angers — Application interne</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <script type="module" src="js/firebase-config.js"></script>
  <script type="module" src="js/dashboard.js"></script>

</body>
</html>
